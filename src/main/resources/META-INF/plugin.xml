<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <!-- Unique identifier of the plugin. It should be FQN. It cannot be changed between the plugin versions. -->
    <id>com.cppcxy.Intellij-SumnekoLua</id>

    <!-- Public plugin name should be written in Title Case.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-name -->
    <name>SumnekoLua</name>

    <!-- A displayed Vendor name or Organization ID displayed on the Plugins Page. -->
    <vendor email="" url="">CppCXY</vendor>

    <!-- Description of the plugin displayed on the Plugin Page and IDE Plugin Manager.
         Simple HTML elements (text formatting, paragraphs, and lists) can be added inside of <![CDATA[ ]]> tag.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-description -->
    <description><![CDATA[
    Support for Lua programming language.<br>

    <h1>lua-language-server</h1>

    <p><strong><em>Lua development just got a whole lot better</em></strong> ğŸ§ </p>

    <p>The Lua language server provides various language features for Lua to make development easier and faster. With around half a million installs on Visual Studio Code, it is the most popular extension for Lua language support.</p>

    <h2>Features</h2>

    <ul>
    <li>âš™ï¸ Supports <code>Lua 5.4</code>, <code>Lua 5.3</code>, <code>Lua 5.2</code>, <code>Lua 5.1</code>, and <code>LuaJIT</code></li>
    <li>ğŸ“„ Over 20 supported <a href="https://github.com/LuaLS/lua-language-server/wiki/Annotations">annotations</a> for documenting your code</li>
    <li>â†ª Go to definition</li>
    <li>ğŸ¦º Dynamic <a href="https://github.com/LuaLS/lua-language-server/wiki/Type-Checking">type checking</a></li>
    <li>ğŸ” Find references</li>
    <li>âš ï¸ <a href="https://github.com/LuaLS/lua-language-server/wiki/Diagnostics">Diagnostics/Warnings</a></li>
    <li>ğŸ•µï¸ <a href="https://github.com/LuaLS/lua-language-server/wiki/Syntax-Errors">Syntax checking</a></li>
    <li>ğŸ“ Element renaming</li>
    <li>ğŸ—¨ï¸ Hover to view details on variables, functions, and more</li>
    <li>ğŸ–Šï¸ Autocompletion</li>
    <li>ğŸ“š Support for <a href="https://github.com/LuaLS/lua-language-server/wiki/Libraries">libraries</a></li>
    <li>ğŸ’… <a href="https://github.com/LuaLS/lua-language-server/wiki/Formatter">Code formatting</a></li>
    <li>ğŸ’¬ <a href="https://github.com/LuaLS/lua-language-server/wiki/Formatter">Spell checking</a></li>
    <li>ğŸ› ï¸ Custom <a href="https://github.com/LuaLS/lua-language-server/wiki/Plugins">plugins</a></li>
    <li>ğŸ“– <a href="https://github.com/LuaLS/lua-language-server/wiki/Export-Documentation">Documentation Generation</a></li>
    </ul>

    <h2>Install</h2>

    <p>The language server can be installed for use in Visual Studio Code, NeoVim, and any <a href="https://microsoft.github.io/language-server-protocol/implementors/tools/">other clients</a> that support the <a href="https://microsoft.github.io/language-server-protocol/">Language Server Protocol</a>. The language server can be configured using a <a href="https://github.com/LuaLS/lua-language-server/wiki/Configuration-File">configuration file</a>. For a more detailed intro, check out the <a href="https://github.com/LuaLS/lua-language-server/wiki/Getting-Started">getting started page in the wiki</a>.</p>

    <h3>Visual Studio Code</h3>

    <p><a href="https://marketplace.visualstudio.com/items?itemName=sumneko.lua">Install in VS Code</a></p>

    <p>The language server and Visual Studio Code client can be installed from <a href="https://marketplace.visualstudio.com/items?itemName=sumneko.lua">the VS Code Marketplace</a>.</p>

    <h3>NeoVim</h3>

    <p><a href="https://github.com/neovim/nvim-lspconfig/blob/master/doc/server_configurations.md#lua_ls">Install for NeoVim</a></p>

    <p>View the installation instructions for NeoVim in the <a href="https://github.com/neovim/nvim-lspconfig/blob/master/doc/server_configurations.md#lua_ls">nvim-lspconfig repo</a>.</p>

    <p>For a guide to getting started from scratch using Mason, read <a href="https://dev.to/vonheikemen/getting-started-with-neovims-native-lsp-client-in-the-year-of-2022-the-easy-way-bp3">Heiker's guide</a>.</p>

    <h3>Command Line</h3>

    <p><a href="https://github.com/LuaLS/lua-language-server/wiki/Getting-Started#command-line">Install for command line</a></p>

    <p>Check the <a href="https://github.com/LuaLS/lua-language-server/wiki/Getting-Started#command-line">wiki for a guide</a> to install the language server for use on the command line. This allows the language server to be used with <a href="https://microsoft.github.io/language-server-protocol/implementors/tools/">other clients</a> that follow the <a href="https://microsoft.github.io/language-server-protocol/overviews/lsp/overview/">language server protocol</a>.</p>

    <h3>Community Install Methods</h3>

    <p>The install methods below are maintained by community members.</p>

    <p><a href="https://github.com/bellini666/asdf-lua-language-server">asdf plugin</a></p>

    <h2>Links</h2>

    <ul>
    <li><a href="https://github.com/LuaLS/lua-language-server/blob/master/changelog.md">Changelog</a></li>
    <li><a href="https://github.com/LuaLS/lua-language-server/wiki">Wiki</a></li>
    <li><a href="https://github.com/LuaLS/lua-language-server/wiki/FAQ">FAQ</a></li>
    <li><a href="https://github.com/LuaLS/lua-language-server/issues">Report an issue</a></li>
    <li><a href="https://github.com/LuaLS/lua-language-server/issues">Suggest a feature</a></li>
    <li><a href="https://github.com/LuaLS/lua-language-server/discussions">Discuss</a></li>
    </ul>

    <blockquote>
      <p>If you find any mistakes, please <a href="https://github.com/LuaLS/lua-language-server/issues">report it</a> or open a <a href="https://github.com/LuaLS/lua-language-server/pulls">pull request</a> if you have a fix of your own â¤ï¸</p>

      <p>å¦‚æœä½ å‘ç°äº†ä»»ä½•é”™è¯¯ï¼Œè¯·<a href="https://github.com/LuaLS/lua-language-server/issues">å‘Šè¯‰æˆ‘</a>æˆ–ä½¿ç”¨<a href="https://github.com/LuaLS/lua-language-server/pulls">Pull Requests</a>æ¥ç›´æ¥ä¿®å¤ã€‚â¤ï¸</p>
    </blockquote>

    <h2>Available Languages</h2>

    <ul>
    <li><code>en-us</code> ğŸ‡ºğŸ‡¸</li>
    <li><code>zh-cn</code> ğŸ‡¨ğŸ‡³</li>
    <li><code>zh-tw</code> ğŸ‡¹ğŸ‡¼</li>
    <li><code>pt-br</code> ğŸ‡§ğŸ‡·</li>
    </ul>

    <blockquote>
      <p><strong>Note</strong>
      All translations are provided and collaborated on by the community. If you find an inappropriate or harmful translation, <a href="https://github.com/LuaLS/lua-language-server/issues">please report it immediately</a>.</p>
    </blockquote>

    <p>Are you able to <a href="https://github.com/LuaLS/lua-language-server/wiki/Translations">provide a translation</a>? It would be greatly appreciated!</p>

    <p>Thank you to <a href="https://github.com/LuaLS/lua-language-server/commits/master/locale">all contributors of translations</a>!</p>

    <h2>Privacy</h2>

    <p>The language server had <strong>opt-in</strong> telemetry that collected usage data and sent it to the development team to help improve the extension. Read our <a href="https://github.com/LuaLS/lua-language-server/wiki/Home#privacy">privacy policy</a> to learn more. Telemetry was removed in <code>v3.6.5</code> and is no longer part of the language server.</p>

    <h2>Credit</h2>

    <p>Software that the language server (or the development of it) uses:</p>

    <ul>
    <li><a href="https://github.com/actboy168/bee.lua">bee.lua</a></li>
    <li><a href="https://github.com/actboy168/luamake">luamake</a></li>
    <li><a href="https://github.com/sqmedeiros/lpeglabel">LPegLabel</a></li>
    <li><a href="https://github.com/LuaLS/LuaParser">LuaParser</a></li>
    <li><a href="https://github.com/NickeManarin/ScreenToGif">ScreenToGif</a></li>
    <li><a href="https://github.com/microsoft/vscode-languageserver-node">vscode-languageclient</a></li>
    <li><a href="https://github.com/textmate/lua.tmbundle">lua.tmbundle</a></li>
    <li><a href="https://emmylua.github.io">EmmyLua</a></li>
    <li><a href="https://github.com/LuaLS/lua-glob">lua-glob</a></li>
    <li><a href="https://github.com/LuaLS/utility">utility</a></li>
    <li><a href="https://github.com/actboy168/vscode-lua-doc">vscode-lua-doc</a></li>
    <li><a href="https://github.com/actboy168/json.lua">json.lua</a></li>
    <li><a href="https://github.com/CppCXY/EmmyLuaCodeStyle">EmmyLuaCodeStyle</a></li>
    <li><a href="https://github.com/kikito/inspect.lua">inspect.lua</a></li>
    </ul>

  ]]></description>

    <!-- Product and plugin compatibility requirements.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->

    <depends>com.intellij.modules.platform</depends>
    <depends>com.redhat.devtools.lsp4ij</depends>
    <idea-version since-build="251"/>
    <!-- Extension points defined by the plugin.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-extension-points.html -->
    <extensions defaultExtensionNs="com.intellij">
        <fileType name="lua"
                  implementationClass="com.tang.intellij.lua.lang.LuaFileType"
                  fieldName="INSTANCE"
                  extensions="lua"
                  language="Lua"/>

        <!--        folding-->
        <lang.foldingBuilder language="Lua" implementationClass="com.tang.intellij.lua.folding.LuaFoldingBuilder"/>
        <lang.foldingBuilder language="Lua"
                             implementationClass="com.tang.intellij.lua.folding.LuaRegionFoldingBuilder"/>

        <lang.parserDefinition language="Lua" implementationClass="com.tang.intellij.lua.lang.LuaParserDefinition"/>
        <lang.braceMatcher language="Lua" implementationClass="com.tang.intellij.lua.braces.LuaBraceMatcher"/>
        <lang.quoteHandler language="Lua"
                           implementationClass="com.tang.intellij.lua.codeInsight.editorActions.LuaQuoteHandler"
                           order="first"/>
        <!--        <languageInjector implementation="com.tang.intellij.lua.lang.LuaLanguageInjector"/>-->

        <customPasteProvider
                implementation="com.tang.intellij.lua.codeInsight.editorActions.StringLiteralPasteProvider"/>

        <!-- è‡ªå®šä¹‰å•è¯é€‰æ‹©å¤„ç†å™¨ -->
        <extendWordSelectionHandler
                implementation="com.tang.intellij.lua.codeInsight.editorActions.LuaWordSelectionHandler"/>

        <!--        highlight-->
        <lang.syntaxHighlighterFactory
                language="Lua"
                implementationClass="com.tang.intellij.lua.highlighting.LuaSyntaxHighlighterFactory"/>
        <!--        <highlightErrorFilter implementation="com.tang.intellij.lua.highlighting.LuaHighlightErrorFilter"/>-->

        <!-- LSP å¤–éƒ¨æ³¨è§£å™¨ - æ›´é«˜ä¼˜å…ˆçº§ -->
<!--        <externalAnnotator language="Lua"-->
<!--                           implementationClass="com.tang.intellij.lua.annotator.LuaLspExternalAnnotator"/>-->

        <highlightUsagesHandlerFactory
                implementation="com.tang.intellij.lua.codeInsight.highlighting.LuaHighlightUsagesHandlerFactory"/>

        <spellchecker.support implementationClass="com.tang.intellij.lua.spellchecker.LuaSpellcheckingStrategy" language="Lua"/>
        <spellchecker.bundledDictionaryProvider implementation="com.tang.intellij.lua.spellchecker.LuaSpellBundledDictionaryProvider"/>

        <!-- <readWriteAccessDetector implementation="com.tang.intellij.lua.codeInsight.LuaReadWriteAccessDetector"/> -->

        <!-- file template provider -->
        <fileTemplateGroup implementation="com.tang.intellij.lua.actions.LuaFileTemplateProvider"/>
        <!-- Internal file templates - must be registered for CreateFileFromTemplateAction -->
        <internalFileTemplate name="LuaClass"/>
        <internalFileTemplate name="LuaModule"/>
        <internalFileTemplate name="LuaEnum"/>
        <internalFileTemplate name="LuaUnity"/>
        <internalFileTemplate name="LuaEmpty"/>
        <!--CreateFromTemplate-->
        <createFromTemplateHandler implementation="com.tang.intellij.lua.actions.LuaCreateFromTemplateHandler"/>
        <moduleType id="LUA_MODULE" implementationClass="com.tang.intellij.lua.project.LuaModuleType"/>
        <directoryProjectGenerator implementation="com.tang.intellij.lua.project.LuaDirectoryProjectGenerator"/>
        <!-- for displaying the statusbar icon -->

        <!-- for settings-->
        <applicationService
                serviceImplementation="com.cppcxy.ide.setting.SumnekoSettings"/>
        <applicationConfigurable
                groupId="language"
                instance="com.cppcxy.ide.setting.SumnekoSettingsPanel"
                displayName="SumnekoLua Settings"
                id="SumnekoLua.Settings"
        >
        </applicationConfigurable>

        <statusBarWidgetFactory id="SumnekoBar" implementation="com.cppcxy.ide.editor.statusbar.StatusBarWidgetFactory"/>
        <lang.commenter language="Lua" implementationClass="com.tang.intellij.lua.comment.LuaCommenter"/>
        <codeInsight.parameterInfo
                language="Lua"
                implementationClass="com.redhat.devtools.lsp4ij.features.signatureHelp.LSPParameterInfoHandler"/>
        <!-- LSP textDocument/documentSymbol -->
        <lang.psiStructureViewFactory
                id="SumnekoLua"
                language="Lua"
                implementationClass="com.redhat.devtools.lsp4ij.features.documentSymbol.LSPDocumentSymbolStructureViewFactory"/>
<!--        <enterHandlerDelegate implementation="com.tang.intellij.lua.editor.LuaEnterHandlerDelegate"/>-->
<!--        <typedHandler implementation="com.tang.intellij.lua.editor.LuaTypedHandler"/>-->
        <lineIndentProvider implementation="com.tang.intellij.lua.editor.LuaLineIndentProvider"/>
    </extensions>
    <extensions defaultExtensionNs="com.redhat.devtools.lsp4ij">
        <server id="SumnekoLua"
                name="Sumneko"
                factoryClass="com.cppcxy.ide.lsp.LspFactory">
            <description><![CDATA[
                <p>Sumneko Lua</p>
    ]]>
            </description>
        </server>
        <languageMapping language="Lua"
                         serverId="SumnekoLua"/>
    </extensions>

    <actions>
        <action class="com.tang.intellij.lua.actions.CreateLuaFileAction"
                text="Lua File"
                id="lua.newFile">
            <add-to-group group-id="NewGroup" anchor="before" relative-to-action="NewFromTemplate"/>
        </action>
    </actions>
</idea-plugin>